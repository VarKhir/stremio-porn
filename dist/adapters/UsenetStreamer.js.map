{"version":3,"sources":["../../src/adapters/UsenetStreamer.js"],"names":["UsenetStreamer","BaseAdapter","constructor","httpClient","options","baseUrl","replace","supportsId","id","escapedPrefixes","ID_PREFIXES","map","prefix","regex","RegExp","join","test","_normalizeStream","stream","name","DISPLAY_NAME","title","_findByPage","_getItem","_getStreams","type","url","encodeURIComponent","body","request","json","Array","isArray","streams"],"mappings":";;;;;;;AAAA;;;;;;;;;;AAGA,MAAMA,cAAN,SAA6BC,oBAA7B,CAAyC;AAMvCC,cAAYC,UAAZ,EAAwBC,UAAU,EAAlC,EAAsC;AACpC,UAAMD,UAAN;AACA,SAAKE,OAAL,GAAeD,QAAQC,OAAR,GAAkBD,QAAQC,OAAR,CAAgBC,OAAhB,CAAwB,MAAxB,EAAgC,EAAhC,CAAlB,GAAwD,EAAvE;AACD;;AAEDC,aAAWC,EAAX,EAAe;AACb,QAAI,CAAC,KAAKH,OAAN,IAAiB,CAACG,EAAtB,EAA0B;AACxB,aAAO,KAAP;AACD;;AAED,QAAIC,kBAAkB,KAAKP,WAAL,CAAiBQ,WAAjB,CAA6BC,GAA7B,CAAkCC,MAAD,IAAY;AACjE,aAAOA,OAAON,OAAP,CAAe,uBAAf,EAAwC,MAAxC,CAAP;AACD,KAFqB,CAAtB;AAIA,QAAIO,QAAQ,IAAIC,MAAJ,CAAY,KAAIL,gBAAgBM,IAAhB,CAAqB,GAArB,CAA0B,OAA1C,EAAkD,GAAlD,CAAZ;AACA,WAAOF,MAAMG,IAAN,CAAWR,EAAX,CAAP;AACD;;AAEDS,mBAAiBC,MAAjB,EAAyB;AACvB,WAAO,MAAMD,gBAAN,mBACFC,MADE;AAELC,YAAMD,OAAOC,IAAP,IAAe,KAAKjB,WAAL,CAAiBkB,YAFjC;AAGLC,aAAOH,OAAOG,KAAP,IAAgBH,OAAOC,IAAvB,IAA+B,KAAKjB,WAAL,CAAiBkB;AAHlD,OAAP;AAKD;;AAEKE,aAAN,GAAoB;AAAA;AAClB;AACA,aAAO,EAAP;AAFkB;AAGnB;;AAEKC,UAAN,GAAiB;AAAA;AACf,aAAO,IAAP;AADe;AAEhB;;AAEKC,aAAN,CAAkBC,IAAlB,EAAwBjB,EAAxB,EAA4B;AAAA;;AAAA;AAC1B,UAAI,CAAC,MAAKH,OAAV,EAAmB;AACjB,eAAO,EAAP;AACD;;AAED,UAAIqB,MAAO,GAAE,MAAKrB,OAAQ,WAAUoB,IAAK,IAAGE,mBAAmBnB,EAAnB,CAAuB,OAAnE;AACA,UAAI;AAAEoB;AAAF,gBAAiB,MAAKzB,UAAL,CAAgB0B,OAAhB,CAAwBH,GAAxB,EAA6B;AAAEI,cAAM;AAAR,OAA7B,CAArB;;AAEA,UAAIC,MAAMC,OAAN,CAAcJ,IAAd,CAAJ,EAAyB;AACvB,eAAOA,IAAP;AACD;;AAED,UAAI,CAACA,IAAD,IAAS,OAAOA,IAAP,KAAgB,QAA7B,EAAuC;AACrC,eAAO,EAAP;AACD;;AAED,UAAIK,UAAUL,KAAKK,OAAnB;AAEA,aAAOF,MAAMC,OAAN,CAAcC,OAAd,IAAyBA,OAAzB,GAAmC,EAA1C;AAlB0B;AAmB3B;;AA5DsC;;gEAAnCjC,c,kBACkB,Q,sBACG,CAAC,OAAD,EAAU,IAAV,C,iBACL,Q,kBACC,CAAC,IAAD,EAAO,MAAP,EAAe,MAAf,EAAuB,QAAvB,C;;eA4DRA,c","sourcesContent":["import BaseAdapter from './BaseAdapter'\n\n\nclass UsenetStreamer extends BaseAdapter {\n  static DISPLAY_NAME = 'Usenet'\n  static SUPPORTED_TYPES = ['movie', 'tv']\n  static CATALOG_ID = 'usenet'\n  static ID_PREFIXES = ['tt', 'tmdb', 'tvdb', 'nzbdav']\n\n  constructor(httpClient, options = {}) {\n    super(httpClient)\n    this.baseUrl = options.baseUrl ? options.baseUrl.replace(/\\/+$/, '') : ''\n  }\n\n  supportsId(id) {\n    if (!this.baseUrl || !id) {\n      return false\n    }\n\n    let escapedPrefixes = this.constructor.ID_PREFIXES.map((prefix) => {\n      return prefix.replace(/[-/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&')\n    })\n\n    let regex = new RegExp(`^(${escapedPrefixes.join('|')})(:)?`, 'i')\n    return regex.test(id)\n  }\n\n  _normalizeStream(stream) {\n    return super._normalizeStream({\n      ...stream,\n      name: stream.name || this.constructor.DISPLAY_NAME,\n      title: stream.title || stream.name || this.constructor.DISPLAY_NAME,\n    })\n  }\n\n  async _findByPage() {\n    // UsenetStreamer does not expose catalogs; discovery is handled by other adapters.\n    return []\n  }\n\n  async _getItem() {\n    return null\n  }\n\n  async _getStreams(type, id) {\n    if (!this.baseUrl) {\n      return []\n    }\n\n    let url = `${this.baseUrl}/stream/${type}/${encodeURIComponent(id)}.json`\n    let { body } = await this.httpClient.request(url, { json: true })\n\n    if (Array.isArray(body)) {\n      return body\n    }\n\n    if (!body || typeof body !== 'object') {\n      return []\n    }\n\n    let streams = body.streams\n\n    return Array.isArray(streams) ? streams : []\n  }\n}\n\n\nexport default UsenetStreamer\n"],"file":"UsenetStreamer.js"}